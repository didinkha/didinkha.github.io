const initMnhBuilder=(e,t)=>{let n=`\n    #${e} * { transition: all 0.3s ease-out; }\n    #${e} .row { transition: padding 0.3s; }\n    #${e} .row:hover { border-left: 2px solid red; padding-left: 50px; }\n    #${e} .row div .hoverable:hover { opacity: 0.5; cursor: pointer; }\n  `;const o=document.createElement("style");o.textContent=n,document.head.append(o);let r={toolbar:[{name:"basicstyles",items:["Source","Bold","Italic","Underline","Strike"]},{name:"paragraph",items:["NumberedList","BulletedList","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"links",items:["Link","Unlink"]},{name:"styles",items:["Styles","Format"]}],forcePasteAsPlainText:!0},a=document.createElement("div");a.id="contentEditorForm",a.style.position="absolute",a.style.width="100%",a.style.height="100%",a.style.zIndex="9999",a.style.display="grid",a.style.placeItems="center",a.style.backgroundColor="rgba(0,0,0,0.5)";const l=()=>{document.querySelector(`#${e}`).innerHTML="",mnhPageStructure.forEach((t,n,o)=>{let i=document.createElement("div"),c=document.createElement("div");c.id=`row-${n}`,c.style.position="absolute",c.style.opacity="0",c.style.marginLeft="-40px",c.style.fontSize="0.5em",c.style.zIndex="999",c.style.cursor="pointer",c.innerHTML=`\n      <button id="remove-row-${n}" title="Hapus panel ini" class="btn btn-link text-danger btn-sm m-0 p-0"><i class="fa fa-fw fa-trash-alt"></i></button>\n      <button id="edit-classes-row-${n}" title="Edit Class" class="btn btn-link text-danger btn-sm m-0 p-0"><i class="fa fa-fw fa-cog"></i></button>\n      <br/>\n      <button id="move-up-row-${n}" title="Pindahkan ke Atas" class="btn btn-link text-danger btn-sm m-0 p-0"><i class="fa fa-fw fa-arrow-up"></i></button>\n      <button id="move-down-row-${n}" title="Pindahkan ke Bawah" class="btn btn-link text-danger btn-sm m-0 p-0"><i class="fa fa-fw fa-arrow-down"></i></button>\n      `,c.querySelector(`#remove-row-${n}`).onclick=(()=>{if(confirm("Apakah Anda yakin ingin menghapus panel ini?")){let e=mnhPageStructure;e.splice(n,1),mnhPageStructure=e,l()}}),c.querySelector(`#move-up-row-${n}`).onclick=(()=>{if(n<=0)alert("Posisi panel sudah berada di paling atas.");else{let e=mnhPageStructure[n-1];mnhPageStructure[n-1]=mnhPageStructure[n],mnhPageStructure[n]=e}l()}),c.querySelector(`#move-down-row-${n}`).onclick=(()=>{if(n>=mnhPageStructure.length-1)alert("Posisi panel sudah berada di paling bawah.");else{let e=mnhPageStructure[n+1];mnhPageStructure[n+1]=mnhPageStructure[n],mnhPageStructure[n]=e}l()}),c.querySelector(`#edit-classes-row-${n}`).onclick=(()=>{let e=mnhPageStructure[n].classes.join(" "),t=prompt("Masukkan class untuk panel ini:",e);if(t){let e=t.split(" ");mnhPageStructure[n].classes=e}l()}),i.onmouseover=(()=>{i.querySelector(`#row-${n}`).style.opacity="1"}),i.onmouseout=(()=>{i.querySelector(`#row-${n}`).style.opacity="0"}),i.appendChild(c),t.classes.forEach(e=>{i.classList.add(e)}),t.cols.forEach((e,t,o)=>{let c=document.createElement("div");e.classes.forEach(e=>{c.classList.add(e)}),c.setAttribute("data-parent",n),c.setAttribute("data-child",t),!e.content||e.content.length<1?c.innerHTML="\n        <div class='text-center hoverable p-4 mt-2 mb-4 rounded-lg' style=\"color:gray; background-color:#e3e3e3\">\n          <small>Kolom kosong</small>\n        </div>\n        ":e.content.forEach((e,o)=>{let i=document.createElement("div");i.style.position="relative";let s=`\n            <div id='row-${n}-col-${t}-item-${o}' style="position:absolute;height:100%;width:100%;display:grid;place-items:center;opacity:0;z-index:900; background-color: rgba(255, 255, 255, 0.8)">\n              <span class="bg-white shadow px-3 py-2 rounded-pill">\n               <small>\n                <a class="text-danger" id="edit-content-row-${n}-col-${t}-item-${o}" title="Edit Konten" href="#"><i class="fa fa-fw fa-edit mx-1"></i></a>\n                <a class="text-danger" id="move-up-content-row-${n}-col-${t}-item-${o}" title="Pindahkan ke atas" href="#"><i class="fa fa-fw fa-arrow-up mx-1"></i></a>\n                <a class="text-danger" id="move-down-content-row-${n}-col-${t}-item-${o}" title="Pindahkan ke bawah" href="#"><i class="fa fa-fw fa-arrow-down mx-1"></i></a>\n                <a class="text-danger" id="delete-content-row-${n}-col-${t}-item-${o}" title="Hapus Konten" href="#"><i class="fa fa-fw fa-trash-alt mx-1"></i></a>\n               </small>\n              </span>\n            </div>\n            `;i.innerHTML=`${s}<div class="hoverable">${e}</div>`,i.addEventListener("mouseover",()=>{i.querySelector(`#row-${n}-col-${t}-item-${o}`).style.opacity="1"}),i.addEventListener("mouseleave",()=>{i.querySelector(`#row-${n}-col-${t}-item-${o}`).style.opacity="0"}),i.querySelector(`#edit-content-row-${n}-col-${t}-item-${o}`).addEventListener("click",()=>{if(mnhPageStructure[n].cols[t].content[o].startsWith('<div data-type="img"')){let e=(new DOMParser).parseFromString(mnhPageStructure[n].cols[t].content[o],"text/xml"),r=a;r.innerHTML=`\n                  <div style="max-width:679px; width:100%" class="p-3 p-md-4 bg-white shadow rounded-lg">\n                  <h6>Masukkan detail gambar:</h6>\n                  \n                  <div class="my-4">\n                  <input type="text" value="${e.querySelector("img").getAttribute("src")}" id="editorImageURL" class="form-control form-control-sm mb-2" placeholder="URL Gambar (Contoh: https://example.com/gambar.jpg)" />\n                  <input type="text" value="${e.querySelector("img").getAttribute("alt")}" id="editorImageAlt" class="form-control form-control-sm mb-2" placeholder="Deskripsi gambar (Contoh: Logo Organisasi, Mitra Organsisasi, dll)" />\n                  <input type="text" value="${e.querySelector("a")?e.querySelector("a").getAttribute("href"):""}" id="editorImageHref" class="form-control form-control-sm mb-2" placeholder="Masukkan link ketika gambar diklik (Contoh: https://example.com)" />\n                  <input type="text" value="${e.querySelector("img").getAttribute("class")}" id="editorImageClass" class="form-control form-control-sm mb-2" placeholder="Class <img> (pisahkan dengan spasi) (Contoh: rounded-circle, w-100, dll)" />\n                  <input type="text" value="${e.querySelector("div").getAttribute("class")}" id="editorContainerClass" class="form-control form-control-sm mb-2" placeholder="Class <div> (pisahkan dengan spasi) (Contoh: text-center, bg-dark, dll)" />\n                  </div>\n        \n                  <hr/>\n                  <h6>Pratinjau kode:</h6>\n                  <pre id="editorImageCodePreview"></pre>\n        \n                  <div class="text-center pt-3">\n                    <button class="btn btn-danger rounded-pill px-3 btn-sm" id="contentEditorFormSave">Simpan Konten</button>\n                    <a href="#" class="btn btn-link btn-sm text-danger" id="contentEditorFormCancel">Cancel</a>\n                  </div>\n                  </div>\n                  `;let i=()=>{r.querySelector("#editorImageCodePreview").textContent=`<div data-type="img" class="${r.querySelector("#editorContainerClass").value}">\n  ${r.querySelector("#editorImageHref").value?`<a href="${r.querySelector("#editorImageHref").value}">`:""}<img \n    src="${r.querySelector("#editorImageURL").value}" \n    alt="${r.querySelector("#editorImageAlt").value}" \n    class="${r.querySelector("#editorImageClass").value}" \n  />${r.querySelector("#editorImageHref").value?"</a>":""}\n</div>`};i(),r.querySelectorAll("input").forEach(e=>{e.addEventListener("keyup",()=>{i()})}),r.querySelector("#contentEditorFormSave").onclick=(()=>{if(r.querySelector("#editorImageURL").value&&r.querySelector("#editorImageAlt").value){let e=r.querySelector("#editorImageCodePreview").textContent;mnhPageStructure[n].cols[t].content[o]=e,l(),document.querySelector("#contentEditorForm").remove()}else alert("URL dan deskripsi Gambar harus diisi!")}),r.querySelector("#contentEditorFormCancel").onclick=(()=>{document.querySelector("#contentEditorForm").remove()}),document.body.insertBefore(a,document.body.firstChild)}else if(mnhPageStructure[n].cols[t].content[o].startsWith('<div data-type="content"')){let e=a;e.innerHTML=`\n                <div style="max-width:679px; width:100%" class="p-3 p-md-4 bg-white shadow rounded-lg">\n                  <textarea name="ckeditor">${mnhPageStructure[n].cols[t].content[o]}</textarea>\n                  <div class="text-center pt-3">\n                    <button class="btn btn-danger rounded-pill px-3 btn-sm" id="contentEditorFormSave">Simpan Konten</button>\n                    <a href="#" class="btn btn-link btn-sm text-danger" id="contentEditorFormCancel">Cancel</a>\n                  </div>\n                </div>\n                `,e.querySelector("#contentEditorFormSave").onclick=(()=>{let e=CKEDITOR.instances.ckeditor.getData();mnhPageStructure[n].cols[t].content[o]=e,l(),document.querySelector("#contentEditorForm").remove()}),e.querySelector("#contentEditorFormCancel").onclick=(()=>{document.querySelector("#contentEditorForm").remove()}),document.body.insertBefore(a,document.body.firstChild),CKEDITOR.replace("ckeditor",r)}}),i.querySelector(`#delete-content-row-${n}-col-${t}-item-${o}`).addEventListener("click",()=>{confirm("Apakah Anda yakin ingin menghapus konten ini?")&&(mnhPageStructure[n].cols[t].content.splice(o,1),l())}),i.querySelector(`#move-up-content-row-${n}-col-${t}-item-${o}`).addEventListener("click",()=>{if(o<=0)alert("Posisi konten sudah berada di paling atas.");else{let e=mnhPageStructure[n].cols[t].content[o-1];mnhPageStructure[n].cols[t].content[o-1]=mnhPageStructure[n].cols[t].content[o],mnhPageStructure[n].cols[t].content[o]=e}l()}),i.querySelector(`#move-down-content-row-${n}-col-${t}-item-${o}`).addEventListener("click",()=>{if(o>=mnhPageStructure[n].cols[t].content.length-1)alert("Posisi konten sudah berada di paling bawah.");else{let e=mnhPageStructure[n].cols[t].content[o+1];mnhPageStructure[n].cols[t].content[o+1]=mnhPageStructure[n].cols[t].content[o],mnhPageStructure[n].cols[t].content[o]=e}l()}),c.appendChild(i)});let s=document.createElement("div");s.classList.add("dropdown"),s.id=`col-${t}-row-${n}-options`,s.style.position="absolute",s.style.right="10px",s.style.top="-15px",s.style.opacity="0",s.style.zIndex="999",s.innerHTML=`\n        <div class="pb-1 px-3 rounded-pill bg-danger shadow">\n         <small>\n         <a title="Tambah Konten" class="text-white mx-1" id="add-content-row-${n}-col-${t}" href="#"><i class="fa fa-fw fa-align-left"></i></a>\n         <a title="Tambah Gambar" class="text-white mx-1" id="add-img-row-${n}-col-${t}" href="#"><i class="fa fa-fw fa-images"></i></a>\n         <a title="Edit Class" class="text-white mx-1" id="modify-class-row-${n}-col-${t}" href="#"><i class="fa fa-fw fa-cog"></i></a>\n         </small>\n        </div>\n      `,c.onmouseover=(()=>{c.querySelector(`#col-${t}-row-${n}-options`).style.opacity="1",c.querySelector(`#col-${t}-row-${n}-options`).style.top="-10px"}),c.onmouseout=(()=>{c.querySelector(`#col-${t}-row-${n}-options`).style.opacity="0",c.querySelector(`#col-${t}-row-${n}-options`).style.top="-15px"}),s.querySelector(`#add-content-row-${n}-col-${t}`).addEventListener("click",()=>{let e=a;e.innerHTML='\n          <div style="max-width:679px; width:100%" class="p-3 p-md-4 bg-white shadow rounded-lg">\n          <textarea name="ckeditor"></textarea>\n          <div class="text-center pt-3">\n            <button class="btn btn-danger rounded-pill px-3 btn-sm" id="contentEditorFormSave">Simpan Konten</button>\n            <a href="#" class="btn btn-link btn-sm text-danger" id="contentEditorFormCancel">Cancel</a>\n          </div>\n          </div>\n          ',e.querySelector("#contentEditorFormSave").onclick=(()=>{let e=`<div data-type="content">${CKEDITOR.instances.ckeditor.getData()}</div>`;mnhPageStructure[n].cols[t].content.push(e),l(),document.querySelector("#contentEditorForm").remove()}),e.querySelector("#contentEditorFormCancel").onclick=(()=>{document.querySelector("#contentEditorForm").remove()}),document.body.insertBefore(a,document.body.firstChild),CKEDITOR.replace("ckeditor",r)}),s.querySelector(`#add-img-row-${n}-col-${t}`).addEventListener("click",()=>{let e=a;e.innerHTML='\n          <div style="max-width:679px; width:100%" class="p-3 p-md-4 bg-white shadow rounded-lg">\n          <h6>Masukkan detail gambar:</h6>\n          \n          <div class="my-4">\n          <input type="text" id="editorImageURL" class="form-control form-control-sm mb-2" placeholder="URL Gambar (Contoh: https://example.com/gambar.jpg)" />\n          <input type="text" id="editorImageAlt" class="form-control form-control-sm mb-2" placeholder="Deskripsi gambar (Contoh: Logo Organisasi, Mitra Organsisasi, dll)" />\n          <input type="text" id="editorImageHref" class="form-control form-control-sm mb-2" placeholder="Masukkan link ketika gambar diklik (Contoh: https://example.com)" />\n          <input type="text" id="editorImageClass" class="form-control form-control-sm mb-2" placeholder="Class <img> (pisahkan dengan spasi) (Contoh: rounded-circle, w-100, dll)" />\n          <input type="text" id="editorContainerClass" class="form-control form-control-sm mb-2" placeholder="Class <div> (pisahkan dengan spasi) (Contoh: text-center, bg-dark, dll)" />\n          </div>\n\n          <hr/>\n          <h6>Pratinjau kode:</h6>\n          <pre id="editorImageCodePreview"></pre>\n\n          <div class="text-center pt-3">\n            <button class="btn btn-danger rounded-pill px-3 btn-sm" id="contentEditorFormSave">Simpan Konten</button>\n            <a href="#" class="btn btn-link btn-sm text-danger" id="contentEditorFormCancel">Cancel</a>\n          </div>\n          </div>\n          ';let o=()=>{e.querySelector("#editorImageCodePreview").textContent=`<div data-type="img" class="${e.querySelector("#editorContainerClass").value}">\n  ${e.querySelector("#editorImageHref").value?`<a href="${e.querySelector("#editorImageHref").value}">`:""}<img \n    src="${e.querySelector("#editorImageURL").value}" \n    alt="${e.querySelector("#editorImageAlt").value}" \n    class="${e.querySelector("#editorImageClass").value}" \n  />${e.querySelector("#editorImageHref").value?"</a>":""}\n</div>`};o(),e.querySelectorAll("input").forEach(e=>{e.addEventListener("keyup",()=>{o()})}),e.querySelector("#contentEditorFormSave").onclick=(()=>{if(e.querySelector("#editorImageURL").value&&e.querySelector("#editorImageAlt").value){let o=e.querySelector("#editorImageCodePreview").textContent;mnhPageStructure[n].cols[t].content.push(o),l(),document.querySelector("#contentEditorForm").remove()}else alert("URL dan deskripsi Gambar harus diisi!")}),e.querySelector("#contentEditorFormCancel").onclick=(()=>{document.querySelector("#contentEditorForm").remove()}),document.body.insertBefore(a,document.body.firstChild)}),s.querySelector(`#modify-class-row-${n}-col-${t}`).addEventListener("click",()=>{let e=mnhPageStructure[n].cols[t].classes.join(" "),o=prompt("Masukkan class untuk kolom ini:",e);if(o){let e=o.split(" ");mnhPageStructure[n].cols[t].classes=e}l()}),c.appendChild(s),i.appendChild(c)}),document.querySelector(`#${e}`).appendChild(i)})};document.querySelector(`#${t}`).onclick=(()=>{let e=prompt("Masukkan jumlah kolom: (Contoh: 1/2/3/4)"),t=parseInt(e);if(t)if(t<1||t>4)alert("Jumlah kolom yang valid adalah 1, 2, 3, dan 4");else{let e=[];switch(t){case 1:e=[{classes:["col-md-12"],content:[]}];break;case 2:e=[{classes:["col-md-6"],content:[]},{classes:["col-md-6"],content:[]}];break;case 3:e=[{classes:["col-md-4"],content:[]},{classes:["col-md-4"],content:[]},{classes:["col-md-4"],content:[]}];break;case 4:e=[{classes:["col-md-3"],content:[]},{classes:["col-md-3"],content:[]},{classes:["col-md-3"],content:[]},{classes:["col-md-3"],content:[]}]}let n={classes:["row"],cols:e};mnhPageStructure.push(n),l()}}),l()};